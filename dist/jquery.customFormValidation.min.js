!function(s){var t=function(t,r){this.customFormValidation=s(t),this.config=s.extend({focusTopSubmit:!0,modifiers:{"!":"not"},customGlobalClasses:{},customFunctions:{}},r||{}),this.classes=s.extend({active:"is-active",open:"is-open",hover:"is-hover",clicked:"is-clicked",extern:"is-external",error:"is-error"},this.config.customGlobalClasses||{}),this.errors=[],this.publicMethods={newError:s.proxy(function(s,t){this.newError(s,t),this.displayErrors()},this),resetErrors:s.proxy(function(){this.resetErrors()},this)},this.init()};s.extend(t.prototype,{init:function(){this.bindEvents()},bindEvents:function(){this.customFormValidation.on("submit",s.proxy(function(s){this.resetErrors(),this.validate(),this.displayErrors(),this.errors.length>0?(s.preventDefault(),this.customFormValidation.trigger("submitErrors")):this.customFormValidation.trigger("submitSuccess")},this))},bindErrorsEvents:function(){this.customFormValidation.find(".errors a").on("click",s.proxy(function(t){var r=this.customFormValidation.find(t.currentTarget.hash).parents(".field").find("label"),i=this.customFormValidation.find(t.currentTarget.hash);i.focus(),s(window).scrollTop(r.offset().top),t.preventDefault()},this))},validate:function(){var t=this.customFormValidation.find("input, textarea, select, fieldset");this.errors=[],t.each(s.proxy(function(s,t){"fieldset"===t.tagName.toLowerCase()?this.validateFieldset(t):this.validateInput(t)},this))},validateInput:function(t){var r,i,e=s(t).val(),o=this.isNumber(e)?parseInt(e):e,n=this.getValidationTerms(t),a=!1;n&&_.each(n,s.proxy(function(e){var n=!0,h=this.getTerm(e),c=this.getModifier(e),d=this.getCompare(t,h);if(!this.isNumber(o)&&this.isNumber(d)&&(o=o.length),"field"===h)r=s(d),i=s(t),i.val()!=r.val()&&(n=!1);else if("regex"===h){var l=new RegExp(d);n=l.test(o)}else c!==!1&&is[c][h]?n=!!is[c][h](o,d)&&n:is[h]?n=!!is[h](o,d)&&n:this.config.customFunctions[h]?n=this.config.customFunctions[h](o,d)?"not"!=c:"not"==c:console.warn("Form comparison function"+(c?" "+c:"")+" "+h+" does not exists.");n||"empty"!==h||(a=!0,this.newError(t,this.getErrorMessage(t,h))),n||a||this.newError(t,this.getErrorMessage(t,h))},this))},validateFieldset:function(t){var r=s(t),i=r.find("input"),e=this.getValidationTerms(t),o=[],n=!1,a=!1;i.each(function(t,i){s(i).is(":checked")?o.push(i):r.data("ranges")===!0&&(a=!0,"0"!==s(i).val()&&o.push(i))}),e&&_.each(e,s.proxy(function(s){var r=!0,e=this.getTerm(s),h=this.getModifier(s),c=this.getCompare(t,e);"empty"===e?(h!==!1&&is[h][e]?(r=!!is[h][e](o,c)&&r,a===!0&&o.length!==i.length&&(r=!1)):is[e]?r=!!is[e](o,c)&&r:console.warn("Form comparison function"+(h?" "+h:"")+" "+e+" does not exists."),r||(n=!0,this.newFieldsetError(t,this.getErrorMessage(t,e)))):(h!==!1&&is[h][e]?r=!!is[h][e](o.length,c)&&r:is[e]?r=!!is[e](o.length,c)&&r:console.warn("Form comparison function"+(h?" "+h:"")+" "+e+" does not exists."),r||n||this.newFieldsetError(t,this.getErrorMessage(t,e)))},this))},getValidationTerms:function(t){var r=s(t).attr("data-validate");return void 0!==r&&r.trim().split(" ")},getTerm:function(s){return"!"===s.charAt(0)?s.substring(1):s},getModifier:function(s){var t=this.config.modifiers[s.charAt(0)];return void 0!==t&&t},getCompare:function(t,r){var i=s(t).data("compare-"+r.toLowerCase());return void 0===i?null:this.isNumber(i)?parseInt(i):i},getErrorMessage:function(t,r){var i=s(t).data("message-"+r.toLowerCase());return void 0!==i?i:""},resetErrors:function(){s(".errors").html(""),this.customFormValidation.find(".field").removeClass(this.classes.error),this.customFormValidation.find(".error-message, .error-message-explanation").remove()},newError:function(t,r){var i=s(t).attr("id"),e=this.customFormValidation.find('label[for="'+i+'"]'),o=e.parents(".field").eq(0),n='<a href="#'+i+'">'+r+"</a>";o.addClass(this.classes.error),0===e.find(".error-message").length&&e.prepend('<span class="error-message">'+this.customFormValidation.data("errors-prefix")+"</span>"),e.append('<span class="error-message-explanation"><span>'+r+"</span></span>"),this.errors.push(n)},newFieldsetError:function(t,r){var i=s(t),e=i.attr("id"),o=i.find("legend"),n='<a href="#'+e+'">'+r+"</a>";i.addClass(this.classes.error),0===o.find(".error-message").length&&o.prepend('<span class="error-message">'+this.customFormValidation.data("errors-prefix")+"</span>"),o.append('<span class="error-message-explanation"><span>'+r+"</span></span>"),this.errors.push(n)},displayErrors:function(){if(this.customFormValidation.find(".errors").remove(),this.errors.length>0){if(this.customFormValidation.prepend('<div class="errors"></div>'),this.customFormValidation.errors=this.customFormValidation.find("> .errors"),this.customFormValidation.errors.append("<p>"+this.customFormValidation.data("errors-message").replace("{n}",this.errors.length).replace("{s}",this.errors.length>1?"s":"")+"</p>"),this.customFormValidation.errors.append("<ul></ul>"),this.customFormValidation.errorsList=this.customFormValidation.find("> .errors > ul"),_.each(this.errors,s.proxy(function(s){this.customFormValidation.errorsList.append("<li>"+s+"</li>")},this)),this.config.focusTopSubmit===!0){var t=this.customFormValidation.find(".errors");t.attr("tabindex",-1),setTimeout(s.proxy(function(){t.focus()},this),0)}this.bindErrorsEvents()}},isNumber:function(s){return!!s&&(s.toString().match(/^[0-9]+$/)&&!isNaN(parseInt(s)))}}),s.fn.customFormValidation=function(r){return this.each(s.proxy(function(i,e){var o=s(e);if(!o.data("custom-form-validation")){var n=new t(e,r);for(var a in n.publicMethods)this[a]=n.publicMethods[a];o.data("custom-form-validation",n)}},this)),this}}(jQuery);