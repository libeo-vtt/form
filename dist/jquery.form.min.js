!function(r){var s=function(s,e){this.form=r(s),this.config=r.extend({focusTopSubmit:!0,modifiers:{"!":"not"},customGlobalClasses:{},customFunctions:{}},e||{}),this.classes=r.extend({active:"is-active",open:"is-open",hover:"is-hover",clicked:"is-clicked",extern:"is-external",error:"is-error"},this.config.customGlobalClasses||{}),this.errors=[],this.publicMethods={newError:r.proxy(function(r,s){this.newError(r,s),this.displayErrors()},this),resetErrors:r.proxy(function(){this.resetErrors()},this)},this.init()};r.extend(s.prototype,{init:function(){this.bindEvents()},bindEvents:function(){this.form.on("submit",r.proxy(function(r){this.resetErrors(),this.validate(),this.displayErrors(),this.errors.length>0?(r.preventDefault(),this.form.trigger("submitErrors")):this.form.trigger("submitSuccess")},this))},bindErrorsEvents:function(){this.form.find(".errors a").on("click",r.proxy(function(s){var e=this.form.find(s.currentTarget.hash).parents(".field").find("label"),t=this.form.find(s.currentTarget.hash);t.focus(),r(window).scrollTop(e.offset().top),s.preventDefault()},this))},validate:function(){var s=this.form.find("input, textarea, select, fieldset");this.errors=[],s.each(r.proxy(function(r,s){"fieldset"===s.tagName.toLowerCase()?this.validateFieldset(s):this.validateInput(s)},this))},validateInput:function(s){var e,t,i=r(s).val(),o=this.isNumber(i)?parseInt(i):i,n=this.getValidationTerms(s),a=!1;n&&_.each(n,r.proxy(function(i){var n=!0,h=this.getTerm(i),f=this.getModifier(i),c=this.getCompare(s,h);if(!this.isNumber(o)&&this.isNumber(c)&&(o=o.length),"field"===h)e=r(c),t=r(s),t.val()!=e.val()&&(n=!1);else if("regex"===h){var d=new RegExp(c);n=d.test(o)}else f!==!1&&is[f][h]?n=!!is[f][h](o,c)&&n:is[h]?n=!!is[h](o,c)&&n:this.config.customFunctions[h]?n=this.config.customFunctions[h](o,c)?"not"!=f:"not"==f:console.warn("Form comparison function"+(f?" "+f:"")+" "+h+" does not exists.");n||"empty"!==h||(a=!0,this.newError(s,this.getErrorMessage(s,h))),n||a||this.newError(s,this.getErrorMessage(s,h))},this))},validateFieldset:function(s){var e=r(s),t=e.find("input"),i=this.getValidationTerms(s),o=[],n=!1,a=!1;t.each(function(s,t){r(t).is(":checked")?o.push(t):e.data("ranges")===!0&&(a=!0,"0"!==r(t).val()&&o.push(t))}),i&&_.each(i,r.proxy(function(r){var e=!0,i=this.getTerm(r),h=this.getModifier(r),f=this.getCompare(s,i);"empty"===i?(h!==!1?(e=!!is[h][i](o,f)&&e,a===!0&&o.length!==t.length&&(e=!1)):e=!!is[i](o,f)&&e,e||(n=!0,this.newFieldsetError(s,this.getErrorMessage(s,i)))):(h!==!1&&is[h][i]?e=!!is[h][i](o.length,f)&&e:is[i]?e=!!is[i](o.length,f)&&e:console.warn("Form comparison function"+(h?" "+h:"")+" "+i+" does not exists."),e||n||this.newFieldsetError(s,this.getErrorMessage(s,i)))},this))},getValidationTerms:function(s){var e=r(s).attr("data-validate");return void 0!==e&&e.trim().split(" ")},getTerm:function(r){return"!"===r.charAt(0)?r.substring(1):r},getModifier:function(r){var s=this.config.modifiers[r.charAt(0)];return void 0!==s&&s},getCompare:function(s,e){var t=r(s).data("compare-"+e.toLowerCase());return void 0===t?null:this.isNumber(t)?parseInt(t):t},getErrorMessage:function(s,e){var t=r(s).data("message-"+e.toLowerCase());return void 0!==t?t:""},resetErrors:function(){r(".errors").html(""),this.form.find(".field").removeClass(this.classes.error),this.form.find(".error-message, .error-message-explanation").remove()},newError:function(s,e){var t=r(s).attr("id"),i=this.form.find('label[for="'+t+'"]'),o=i.parents(".field").eq(0),n='<a href="#'+t+'">'+e+"</a>";o.addClass(this.classes.error),0===i.find(".error-message").length&&i.prepend('<span class="error-message">'+this.form.data("errors-prefix")+"</span>"),i.append('<span class="error-message-explanation"><span>'+e+"</span></span>"),this.errors.push(n)},newFieldsetError:function(s,e){var t=r(s),i=t.attr("id"),o=t.find("legend"),n='<a href="#'+i+'">'+e+"</a>";t.addClass(this.classes.error),0===o.find(".error-message").length&&o.prepend('<span class="error-message">'+this.form.data("errors-prefix")+"</span>"),o.append('<span class="error-message-explanation"><span>'+e+"</span></span>"),this.errors.push(n)},displayErrors:function(){if(this.form.find(".errors").remove(),this.errors.length>0){if(this.form.prepend('<div class="errors"></div>'),this.form.errors=this.form.find("> .errors"),this.form.errors.append("<p>"+this.form.data("errors-message").replace("{n}",this.errors.length).replace("{s}",this.errors.length>1?"s":"")+"</p>"),this.form.errors.append("<ul></ul>"),this.form.errorsList=this.form.find("> .errors > ul"),_.each(this.errors,r.proxy(function(r){this.form.errorsList.append("<li>"+r+"</li>")},this)),this.config.focusTopSubmit===!0){var s=this.form.find(".errors");s.attr("tabindex",-1),setTimeout(r.proxy(function(){s.focus()},this),0)}this.bindErrorsEvents()}},isNumber:function(r){return!!r&&(r.toString().match(/^[0-9]+$/)&&!isNaN(parseInt(r)))}}),r.fn.form=function(e){return this.each(r.proxy(function(t,i){var o=r(i);if(!o.data("form")){var n=new s(i,e);for(var a in n.publicMethods)this[a]=n.publicMethods[a];o.data("form",n)}},this)),this}}(jQuery);